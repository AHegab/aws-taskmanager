{"ast":null,"code":"var _jsxFileName = \"d:\\\\Github\\\\Tasks\\\\aws-taskmanager\\\\my-bootstrap-app2\\\\src\\\\pages\\\\Callback.jsx\",\n  _s = $RefreshSig$();\n// src/pages/Callback.js\nimport { useEffect } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport Cookies from 'js-cookie';\nimport axios from 'axios';\n\n// Configuration - update these values with your actual Cognito settings\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst COGNITO_CONFIG = {\n  domain: 'eu-north-1u8wcgtv8c.auth.eu-north-1.amazoncognito.com',\n  clientId: '6thkk9j96oa02djeccritml1gr',\n  redirectUri: 'http://localhost:3000/callback',\n  tokenEndpoint: '/oauth2/token',\n  // Only include if your app client has a secret (confidential client)\n  clientSecret: 'your_client_secret_here'\n};\nexport default function Callback() {\n  _s();\n  const location = useLocation();\n  const navigate = useNavigate();\n  useEffect(() => {\n    const handleAuthentication = async () => {\n      console.log('Handling authentication callback...');\n      const params = new URLSearchParams(location.search);\n      const code = params.get('code');\n      const error = params.get('error');\n\n      // Handle errors from Cognito\n      if (error) {\n        console.error('Authentication error:', {\n          error: error,\n          description: params.get('error_description'),\n          uri: params.get('error_uri')\n        });\n        navigate(`/login?error=${error}`);\n        return;\n      }\n\n      // Verify we have an authorization code\n      if (!code) {\n        console.error('Missing authorization code');\n        navigate('/login?error=missing_code');\n        return;\n      }\n      try {\n        console.log('Exchanging authorization code for tokens...');\n\n        // Prepare token request parameters\n        const tokenParams = new URLSearchParams();\n        tokenParams.append('grant_type', 'authorization_code');\n        tokenParams.append('client_id', COGNITO_CONFIG.clientId);\n        tokenParams.append('code', code);\n        tokenParams.append('redirect_uri', COGNITO_CONFIG.redirectUri);\n\n        // Include client secret only if configured\n        if (COGNITO_CONFIG.clientSecret) {\n          tokenParams.append('client_secret', COGNITO_CONFIG.clientSecret);\n        }\n\n        // Make token request\n        const response = await axios.post(`https://${COGNITO_CONFIG.domain}${COGNITO_CONFIG.tokenEndpoint}`, tokenParams.toString(), {\n          headers: {\n            'Content-Type': 'application/x-www-form-urlencoded'\n          },\n          timeout: 10000 // 10 second timeout\n        });\n        console.log('Token exchange successful:', {\n          access_token: !!response.data.access_token,\n          id_token: !!response.data.id_token,\n          refresh_token: !!response.data.refresh_token\n        });\n\n        // Store tokens securely\n        Cookies.set('idToken', response.data.id_token, {\n          expires: 1,\n          // 1 day expiration\n          secure: process.env.NODE_ENV === 'production',\n          sameSite: 'lax'\n        });\n        Cookies.set('accessToken', response.data.access_token, {\n          expires: 1,\n          secure: process.env.NODE_ENV === 'production',\n          sameSite: 'lax'\n        });\n        if (response.data.refresh_token) {\n          Cookies.set('refreshToken', response.data.refresh_token, {\n            expires: 30,\n            // 30 days for refresh token\n            secure: process.env.NODE_ENV === 'production',\n            sameSite: 'lax'\n          });\n        }\n\n        // Redirect to home page after successful login\n        navigate('/');\n      } catch (err) {\n        var _err$response, _err$config, _err$config2, _err$config3;\n        console.error('Token exchange failed:', {\n          message: err.message,\n          response: (_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.data,\n          config: {\n            url: (_err$config = err.config) === null || _err$config === void 0 ? void 0 : _err$config.url,\n            method: (_err$config2 = err.config) === null || _err$config2 === void 0 ? void 0 : _err$config2.method,\n            data: (_err$config3 = err.config) === null || _err$config3 === void 0 ? void 0 : _err$config3.data\n          }\n        });\n        let errorMessage = 'token_exchange_failed';\n        if (err.response) {\n          if (err.response.status === 400) {\n            errorMessage = err.response.data.error || 'invalid_request';\n          } else if (err.response.status === 401) {\n            errorMessage = 'invalid_client';\n          }\n        }\n        navigate(`/login?error=${errorMessage}`);\n      }\n    };\n    handleAuthentication();\n  }, [location, navigate]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"callback-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Processing Authentication...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Please wait while we complete your login.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"spinner\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 131,\n    columnNumber: 5\n  }, this);\n}\n_s(Callback, \"fPjCxODVr6jVvib6o2c9VLE4s84=\", false, function () {\n  return [useLocation, useNavigate];\n});\n_c = Callback;\nvar _c;\n$RefreshReg$(_c, \"Callback\");","map":{"version":3,"names":["useEffect","useNavigate","useLocation","Cookies","axios","jsxDEV","_jsxDEV","COGNITO_CONFIG","domain","clientId","redirectUri","tokenEndpoint","clientSecret","Callback","_s","location","navigate","handleAuthentication","console","log","params","URLSearchParams","search","code","get","error","description","uri","tokenParams","append","response","post","toString","headers","timeout","access_token","data","id_token","refresh_token","set","expires","secure","process","env","NODE_ENV","sameSite","err","_err$response","_err$config","_err$config2","_err$config3","message","config","url","method","errorMessage","status","className","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["d:/Github/Tasks/aws-taskmanager/my-bootstrap-app2/src/pages/Callback.jsx"],"sourcesContent":["// src/pages/Callback.js\nimport { useEffect } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport Cookies from 'js-cookie';\nimport axios from 'axios';\n\n// Configuration - update these values with your actual Cognito settings\nconst COGNITO_CONFIG = {\n  domain: 'eu-north-1u8wcgtv8c.auth.eu-north-1.amazoncognito.com',\n  clientId: '6thkk9j96oa02djeccritml1gr',\n  redirectUri: 'http://localhost:3000/callback',\n  tokenEndpoint: '/oauth2/token',\n  // Only include if your app client has a secret (confidential client)\n  clientSecret: 'your_client_secret_here' \n};\n\nexport default function Callback() {\n  const location = useLocation();\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const handleAuthentication = async () => {\n      console.log('Handling authentication callback...');\n      \n      const params = new URLSearchParams(location.search);\n      const code = params.get('code');\n      const error = params.get('error');\n\n      // Handle errors from Cognito\n      if (error) {\n        console.error('Authentication error:', {\n          error: error,\n          description: params.get('error_description'),\n          uri: params.get('error_uri')\n        });\n        navigate(`/login?error=${error}`);\n        return;\n      }\n\n      // Verify we have an authorization code\n      if (!code) {\n        console.error('Missing authorization code');\n        navigate('/login?error=missing_code');\n        return;\n      }\n\n      try {\n        console.log('Exchanging authorization code for tokens...');\n        \n        // Prepare token request parameters\n        const tokenParams = new URLSearchParams();\n        tokenParams.append('grant_type', 'authorization_code');\n        tokenParams.append('client_id', COGNITO_CONFIG.clientId);\n        tokenParams.append('code', code);\n        tokenParams.append('redirect_uri', COGNITO_CONFIG.redirectUri);\n        \n        // Include client secret only if configured\n        if (COGNITO_CONFIG.clientSecret) {\n          tokenParams.append('client_secret', COGNITO_CONFIG.clientSecret);\n        }\n\n        // Make token request\n        const response = await axios.post(\n          `https://${COGNITO_CONFIG.domain}${COGNITO_CONFIG.tokenEndpoint}`,\n          tokenParams.toString(),\n          {\n            headers: {\n              'Content-Type': 'application/x-www-form-urlencoded'\n            },\n            timeout: 10000 // 10 second timeout\n          }\n        );\n\n        console.log('Token exchange successful:', {\n          access_token: !!response.data.access_token,\n          id_token: !!response.data.id_token,\n          refresh_token: !!response.data.refresh_token\n        });\n\n        // Store tokens securely\n        Cookies.set('idToken', response.data.id_token, {\n          expires: 1, // 1 day expiration\n          secure: process.env.NODE_ENV === 'production',\n          sameSite: 'lax'\n        });\n        Cookies.set('accessToken', response.data.access_token, {\n          expires: 1,\n          secure: process.env.NODE_ENV === 'production',\n          sameSite: 'lax'\n        });\n        \n        if (response.data.refresh_token) {\n          Cookies.set('refreshToken', response.data.refresh_token, {\n            expires: 30, // 30 days for refresh token\n            secure: process.env.NODE_ENV === 'production',\n            sameSite: 'lax'\n          });\n        }\n\n        // Redirect to home page after successful login\n        navigate('/');\n\n      } catch (err) {\n        console.error('Token exchange failed:', {\n          message: err.message,\n          response: err.response?.data,\n          config: {\n            url: err.config?.url,\n            method: err.config?.method,\n            data: err.config?.data\n          }\n        });\n\n        let errorMessage = 'token_exchange_failed';\n        if (err.response) {\n          if (err.response.status === 400) {\n            errorMessage = err.response.data.error || 'invalid_request';\n          } else if (err.response.status === 401) {\n            errorMessage = 'invalid_client';\n          }\n        }\n\n        navigate(`/login?error=${errorMessage}`);\n      }\n    };\n\n    handleAuthentication();\n  }, [location, navigate]);\n\n  return (\n    <div className=\"callback-container\">\n      <h2>Processing Authentication...</h2>\n      <p>Please wait while we complete your login.</p>\n      <div className=\"spinner\"></div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}